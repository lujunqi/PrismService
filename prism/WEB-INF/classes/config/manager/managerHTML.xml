<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/beans   
                        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
                        http://www.springframework.org/schema/aop   
                        http://www.springsource.org/schema/aop/spring-aop-3.0.xsd  
                        http://www.springframework.org/schema/tx  
                            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">
	<bean id="user_view" class="com.prism.service.impl.basic.NormalHTMLService">
		<property name="sourceMap">
			<map>
				<entry key="VIEWNAME" value="查询用户" />
				<entry key="MAPPING">
					<list>
						<array>
							<value>姓名</value>
							<value>#@USER_NAME#</value>
						</array>

						<array>
							<value>用户名</value>
							<value>#@LOGIN_NAME#</value>
						</array>
						<array>
							<value>手机号</value>
							<value>#@USER_MOBILE#</value>
						</array>

						<array>
							<value>操作</value>
							<value>#@func:func_user#</value>
						</array>
					</list>
				</entry>
				<entry key="QUERY">
					<value><![CDATA[
						$q.add($el.text("姓名","USER_NAME"));
						$q.add($el.text("用户名","LOGIN_NAME"));]]>
					</value>
				</entry>
				<entry key="DATAURL" value="user_list.do" /><!-- 明细 -->
				<entry key="DATAURLTOTAL" value="user_list_total.do" /><!-- 总记录数 -->

				<entry key="BUTTON">
					<value><![CDATA[
$b.add("<a class=""btn"" href=""javascript:win('url:jsp/manager/user_info_win.jsp','新增用户','user_add.do')"">新增</a>");
function func_user(data){
	var user_id = data["USER_ID"];
	var str ='';	
	str+='<a href="javascript:func_user_opt('+user_id+')">[赋权]</a>';
	str+='<a href="javascript:func_user_upt('+user_id+')">[修改]</a>';
	str+='<a href="javascript:func_user_pwd('+user_id+')">[初始化密码]</a>';
	str+= '<a href="javascript:func_user_del('+user_id+')">[删除]</a>';
	return str;
}
function func_user_opt(nkey){
  
  return $.dialog({
		title:"授权管理",
		width:800,
		height:450,
		fixed: true,
		max: true,
		min: false,
		resize: false,
		drag: true,
		lock: true,
		lockScroll:true,
		content: "url:pa/user_auth_win.v",
		data:{URL:"pa/user_auth_list.s",WIDGET:{USER_ID:nkey}},
		button:[{name:"赋权",
		         callback:function(){
		            var w = {};
  					var dt = [];
  					w["URL"]="pa/user_auth_other_list.s";
  					w["WIDGET"] = {USER_ID:nkey};
  					w["OPENER"] = this.content;
		         	win2("url:pa/user_auth_other_win.v","授权管理",function(){return true;},w);
		         	return false;
		         },
		         focus:true
		         },
		         {name:"取消",
		         callback:function(){
		         	return true;
		         }}]
		
	});
  
}
function func_user_upt(id){
	win("url:jsp/manager/user_info_win.jsp?id="+id,"用户资料修改","user_upt.do");
}
function func_user_del(id){
	confirm("是否删除用户","用户管理",function(){
	$.post("user_del.do",{USER_ID:id},function(data){
		if(data["code"]==1 && data["result"]==1 ){
			queryInfo();
		}else{
			alert("删除失败");
		}
	},"json");
	});
}
function func_user_pwd(id){
	confirm("是否初始化该用户密码","用户管理",function(){
	$.post("user_pwd.do",{USER_ID:id},function(data){
		if(data["code"]==1 && data["result"]==1 ){
			queryInfo();
		}else{
			alert("操作失败");
		}
	},"json");
	});
}					
					]]></value>
					
				</entry>
				<entry key="TEMPLATE" value="/page/model_list.jsp" /><!-- 模板 -->
			</map>
		</property>
	</bean>
	

</beans>