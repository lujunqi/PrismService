<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xmlns:aop="http://www.springframework.org/schema/aop" 
xmlns:tx="http://www.springframework.org/schema/tx" 
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd 
          http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd 
          http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd">
          
	<!-- 登录检测 -->
	<bean id="login" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
SELECT U.USER_ID, U.USER_NAME,U.USER_MOBILE
  FROM SM_USER U
 WHERE U.LOGIN_NAME = ${USER_ACC}
   AND U.LOGIN_PWD = ${USER_PWD}
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>

	<bean id="ManagerAop" class="manager.ManagerAop" />
	<aop:config>
		<aop:aspect ref="ManagerAop">
			<aop:around method="loginCheck" pointcut="bean(login)" />
			<aop:around method="logs" pointcut="execution(* com.prism.service.impl.basic.*.service())" />
			
		</aop:aspect>
	</aop:config>

	<!-- 用户列表 -->
	<bean id="user_list" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="DSQL">
					<value>
<![CDATA[
SELECT USER_ID,USER_NAME,LOGIN_NAME,USER_MOBILE FROM SM_USER
WHERE 1=1
#if(!$v.isEmpty("USER_NAME"))
   AND TRIM(T.USER_NAME) = TRIM(${v.set("USER_NAME","STRING")})
#end
#if(!$v.isEmpty("LOGIN_NAME"))
   AND TRIM(T.LOGIN_NAME) = TRIM(${v.set("LOGIN_NAME","STRING")})
#end

]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>
	<!-- 新增用户 -->
	<bean id="user_add" class="com.prism.service.impl.basic.NormalUptService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
INSERT INTO SM_USER(USER_ID,USER_NAME,LOGIN_NAME,LOGIN_PWD,USER_MOBILE)
VALUES(SEQ_SM_USER.NEXTVAL,${USER_NAME<STRING>},${LOGIN_NAME<STRING>},${LOGIN_PWD<STRING>},${USER_MOBILE<STRING>})
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>
	<!-- 用户信息 -->
	<bean id="user_info" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
SELECT USER_ID,USER_NAME,LOGIN_NAME,USER_MOBILE FROM SM_USER WHERE USER_ID = ${USER_ID<INT>}
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>
	<!-- 用户信息修改 -->
	<bean id="user_upt" class="com.prism.service.impl.basic.NormalUptService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
UPDATE SM_USER SET USER_NAME=${USER_NAME<STRING>},USER_MOBILE=${USER_NAME<STRING>} WHERE USER_ID = ${USER_ID<INT>}
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>
	
	<!-- 用户账号验证 -->
	<bean id="user_check" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
SELECT USER_ID,USER_NAME,LOGIN_NAME,USER_MOBILE FROM SM_USER WHERE LOGIN_NAME = ${LOGIN_NAME<STRING>}
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>

	<!-- 用户列表合计 -->
	<bean id="user_list_total" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
SELECT COUNT(1) TOTAL FROM SM_USER
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>
	
	<!-- 菜单树 -->
	<bean id="index" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
SELECT M.MENU_ID,
       M.MENU_URL,
       M.MENU_NAME,
       LEVEL LV,
       'C' || M.SUP_MENU_ID SUP_MENU
  FROM SM_MENU M
 WHERE M.MENU_STATUS = 0
 START WITH M.SUP_MENU_ID = 0
CONNECT BY PRIOR M.MENU_ID = M.SUP_MENU_ID
 ORDER SIBLINGS BY M.MENU_ORDER
]]>
					</value>
				</entry>
				<entry key="FORWARD" value="index.jsp" />
			</map>
		</property>
	</bean>
	<!-- 菜单管理 -->
	<bean id="menu_list" class="com.prism.service.impl.basic.NormalSltService">
		<property name="sourceMap">
			<map>
				<entry key="SQL">
					<value>
<![CDATA[
SELECT M.MENU_ID, M.MENU_URL, M.MENU_NAME, M.SUP_MENU_ID, LEVEL LV
  FROM SM_MENU M
 WHERE MENU_STATUS = 0
 START WITH SUP_MENU_ID = 0
CONNECT BY PRIOR MENU_ID = SUP_MENU_ID
 ORDER SIBLINGS BY MENU_ORDER
]]>
					</value>
				</entry>
				<entry key="VIEW" value="$v.toJson()" />
			</map>
		</property>
	</bean>

</beans>